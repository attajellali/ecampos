<?xml version="1.0" encoding="UTF-8"?>
<b:beans xmlns="http://www.springframework.org/schema/security"
        xmlns:b="http://www.springframework.org/schema/beans"
    	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">

	<!-- http://static.springsource.org/spring-security/site/docs/3.1.x/reference/ns-config.html#ns-minimal -->
	<!-- Configure Spring Security -->
	
	<http pattern="/css/**" security="none"/>
	<http pattern="/img/**" security="none"/>
	<http pattern="/js/**" security="none"/>
	 
	<http auto-config="true" use-expressions="true">
				
	 	<intercept-url pattern="/login.htm" access="permitAll"/>
	 	<intercept-url pattern="/login.htm" access="ROLE_ADMIN"/> 	
	 	<intercept-url pattern="/**" access="ROLE_USER"/>
	 	
	 	<form-login login-page="/login.htm"  
					default-target-url="/inicio.htm" 
					authentication-failure-url="/login.htm?login_error=1"
					always-use-default-target="true" />
					
		<http-basic/>
		
		<logout invalidate-session="true" logout-success-url="/login.jsp" />
				
		<remember-me />
		
	</http>
	
	<authentication-manager>
		<!-- 
			<authentication-provider user-service-ref="userLoginService">
			 	<password-encoder hash="md5" />
			</authentication-provider>
		 -->
		 
		 <ldap-authentication-provider  
           user-search-filter="(uid={0})" 
           user-search-base="ou=users"
           group-search-filter="(uniqueMember={0})"
           group-search-base="ou=groups"
           group-role-attribute="cn"
           role-prefix="ROLE_"> 
         </ldap-authentication-provider> 
         
         
		 
		 <!-- 
		<authentication-provider>
			<password-encoder hash="md5" />
			<user-service>
				
				<user name="ecampos" password="0ab33f5dd3fa33770e9e7dc3adc90d2f" authorities="ROLE_USER, ROLE_UNO" />
				<user name="menriquez" password="0ab33f5dd3fa33770e9e7dc3adc90d2f" authorities="ROLE_USER, ROLE_DOS" />
				<user name="jperez" password="0ab33f5dd3fa33770e9e7dc3adc90d2f" authorities="ROLE_USER, ROLE_TRES" />
			</user-service>
		</authentication-provider>
		 -->
		
	</authentication-manager>
	
	<ldap-server ldif="classpath:mojo.ldif"  root="o=mojo"/> 

</b:beans>